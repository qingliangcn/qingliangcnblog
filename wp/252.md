<!--
author: qingliangcn
date: 2010-05-13
title: mnesia脏读与事物读性能结果
tags: Erlang,mnesia,事务,脏读
category: Erlang
status: publish
summary: 一直知道mnesia的事务比较慢，但慢到什么程度却没有一个数值的概念，今天正好有空测试一下。上代码：-module(mnesia_read_test).-export([start/0, init_data/0, start2/0]).-record(r_test, {id, n
-->

<p>一直知道mnesia的事务比较慢，但慢到什么程度却没有一个数值的概念，今天正好有空测试一下。</p>
<p>上代码：</p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">-module(mnesia_read_test)</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:blue;
mso-font-kerning:0pt">.</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;mso-font-kerning:0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">-export([start/</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:#5A5AB4;
mso-font-kerning:0pt">0</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">, init_data/</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:#5A5AB4;
mso-font-kerning:0pt">0</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">, start2/</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:#5A5AB4;
mso-font-kerning:0pt">0</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">])</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:blue;
mso-font-kerning:0pt">.</span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">-record(r_test, {id, name})</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:blue;
mso-font-kerning:0pt">.</span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">start() -&gt;</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:
0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>statistics(wall_clock), </span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:
0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span>statistics(runtime),</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:
0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp; </span><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>read(),</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:darkgoldenrod;
mso-font-kerning:0pt">_</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">, </span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:darkgoldenrod;
mso-font-kerning:0pt">Time1</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">} = statistics(wall_clock),</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;mso-font-kerning:0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span>{</span><span lang="EN-US" style="font-size:
10.0pt;font-family:&quot;Courier New&quot;;color:darkgoldenrod;mso-font-kerning:0pt">_</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:black;
mso-font-kerning:0pt">, </span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;color:darkgoldenrod;mso-font-kerning:0pt">Time2</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:black;
mso-font-kerning:0pt">} = statistics(runtime),</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span>io:format(</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:rosybrown;mso-font-kerning:
0pt">&quot;times:~p, wall_clock ~p, runtime:~p&quot;</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:black;mso-font-kerning:
0pt">, [</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;
color:#5A5AB4;mso-font-kerning:0pt">100000</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:black;mso-font-kerning:
0pt">, </span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;
color:darkgoldenrod;mso-font-kerning:0pt">Time1</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:black;mso-font-kerning:
0pt">, </span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;
color:darkgoldenrod;mso-font-kerning:0pt">Time2</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:black;mso-font-kerning:
0pt">])</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;
color:blue;mso-font-kerning:0pt">.</span><span lang="EN-US" style="font-size:
10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;mso-font-kerning:0pt"><o:p>&nbsp;<!--more--></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">start2() -&gt;</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:
0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>statistics(wall_clock),</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:
0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span>statistics(runtime),</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:
0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>read2(),</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:darkgoldenrod;
mso-font-kerning:0pt">_</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">, </span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:darkgoldenrod;
mso-font-kerning:0pt">Time1</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">} = statistics(wall_clock),</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;mso-font-kerning:0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span>{</span><span lang="EN-US" style="font-size:
10.0pt;font-family:&quot;Courier New&quot;;color:darkgoldenrod;mso-font-kerning:0pt">_</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:black;
mso-font-kerning:0pt">, </span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;color:darkgoldenrod;mso-font-kerning:0pt">Time2</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:black;
mso-font-kerning:0pt">} = statistics(runtime),</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span>io:format(</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:rosybrown;mso-font-kerning:
0pt">&quot;times:~p, wall_clock ~p, runtime:~p&quot;</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:black;mso-font-kerning:
0pt">, [</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;
color:#5A5AB4;mso-font-kerning:0pt">100000</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:black;mso-font-kerning:
0pt">, </span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;
color:darkgoldenrod;mso-font-kerning:0pt">Time1</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:black;mso-font-kerning:
0pt">, </span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;
color:darkgoldenrod;mso-font-kerning:0pt">Time2</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:black;mso-font-kerning:
0pt">])</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;
color:blue;mso-font-kerning:0pt">.</span><span lang="EN-US" style="font-size:
10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;mso-font-kerning:0pt"><o:p>&nbsp;</o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">read() -&gt;</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:
0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>dirty_read(</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:#5A5AB4;mso-font-kerning:
0pt">100000</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;
color:black;mso-font-kerning:0pt">)</span><span lang="EN-US" style="font-size:
10.0pt;font-family:&quot;Courier New&quot;;color:blue;mso-font-kerning:0pt">.</span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">dirty_read(</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:#5A5AB4;
mso-font-kerning:0pt">0</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">) -&gt;</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:
0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span>ok;</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">dirty_read(</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:darkgoldenrod;
mso-font-kerning:0pt">N</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">) -&gt;</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:
0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span>mnesia:dirty_read(r_test, </span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:darkgoldenrod;
mso-font-kerning:0pt">N</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">),</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:
0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span>dirty_read(</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:darkgoldenrod;
mso-font-kerning:0pt">N</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">-</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:#5A5AB4;
mso-font-kerning:0pt">1</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">)</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:blue;
mso-font-kerning:0pt">.</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;mso-font-kerning:0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;mso-font-kerning:0pt"><o:p>&nbsp;</o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">read2() -&gt;</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:
0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>t_read(</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:#5A5AB4;mso-font-kerning:
0pt">100000</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;
color:black;mso-font-kerning:0pt">)</span><span lang="EN-US" style="font-size:
10.0pt;font-family:&quot;Courier New&quot;;color:blue;mso-font-kerning:0pt">.</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:
0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;mso-font-kerning:0pt"><o:p>&nbsp;</o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">t_read(</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:#5A5AB4;mso-font-kerning:
0pt">0</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;
color:black;mso-font-kerning:0pt">) -&gt;</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ok;</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">t_read(</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:darkgoldenrod;
mso-font-kerning:0pt">N</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">) -&gt;</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:
0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>mnesia:transaction( </span><b><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:#A020F0;
mso-font-kerning:0pt">fun</span></b><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">() -&gt; mnesia:read(r_test, </span><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:darkgoldenrod;mso-font-kerning:0pt">N</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:black;
mso-font-kerning:0pt">) </span><b><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;color:#A020F0;mso-font-kerning:0pt">end</span></b><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:black;
mso-font-kerning:0pt">),</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;mso-font-kerning:0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>t_read(</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:darkgoldenrod;
mso-font-kerning:0pt">N</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">-</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:#5A5AB4;
mso-font-kerning:0pt">1</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">)</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:blue;
mso-font-kerning:0pt">.</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;mso-font-kerning:0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;mso-font-kerning:0pt"><o:p>&nbsp;</o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">init_data() -&gt;</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:
0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span>mnesia:stop(),</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span>mnesia:create_schema([node()]),</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:
0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span>mnesia:start(),</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span>mnesia:create_table(r_test, [</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:
0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{attributes, record_info(fields, r_test)},</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;mso-font-kerning:0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{record_name, r_test},</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;
mso-font-kerning:0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{disc_copies, [node()]}</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;
mso-font-kerning:0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>]),</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:
0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span>mnesia:transaction(</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><b><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:#A020F0;mso-font-kerning:
0pt">fun</span></b><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;
color:black;mso-font-kerning:0pt">() -&gt;</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>t_write(</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:#5A5AB4;mso-font-kerning:
0pt">10000</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;
color:black;mso-font-kerning:0pt">)</span><span lang="EN-US" style="font-size:
10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><b><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:#A020F0;mso-font-kerning:
0pt">end</span></b><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;
mso-font-kerning:0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span>)</span><span lang="EN-US" style="font-size:
10.0pt;font-family:&quot;Courier New&quot;;color:blue;mso-font-kerning:0pt">.</span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">t_write(</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:#5A5AB4;
mso-font-kerning:0pt">0</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">) -&gt;</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:
0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span>ok;</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">t_write(</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:darkgoldenrod;
mso-font-kerning:0pt">N</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">) -&gt;</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:
0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="font-size:
10.0pt;font-family:&quot;Courier New&quot;;color:darkgoldenrod;mso-font-kerning:0pt">Name</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:black;
mso-font-kerning:0pt"> = lists:append([</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:rosybrown;mso-font-kerning:
0pt">&quot;name_&quot;</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">, </span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:darkgoldenrod;
mso-font-kerning:0pt">N</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">]),</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:
0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="font-size:
10.0pt;font-family:&quot;Courier New&quot;;color:darkgoldenrod;mso-font-kerning:0pt">R</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:black;
mso-font-kerning:0pt"> = #r_test{id=</span><span lang="EN-US" style="font-size:
10.0pt;font-family:&quot;Courier New&quot;;color:darkgoldenrod;mso-font-kerning:0pt">N</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:black;
mso-font-kerning:0pt">, name=</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;color:darkgoldenrod;mso-font-kerning:0pt">Name</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:black;
mso-font-kerning:0pt">},</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;mso-font-kerning:0pt"><o:p></o:p></span></span></font></p>
<p align="left" class="MsoNormal" style="text-align:left;mso-layout-grid-align:
none;text-autospace:none"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span>mnesia:write(</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:darkgoldenrod;
mso-font-kerning:0pt">R</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;color:black;mso-font-kerning:0pt">),</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;mso-font-kerning:
0pt"><o:p></o:p></span></span></font></p>
<p class="MsoNormal"><font class="Apple-style-span" color="#000000" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px;"><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;
color:black;mso-font-kerning:0pt"><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp; </span>t_write(</span><span lang="EN-US" style="font-size:10.0pt;font-family:
&quot;Courier New&quot;;color:darkgoldenrod;mso-font-kerning:0pt">N</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:black;
mso-font-kerning:0pt">-</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;color:#5A5AB4;mso-font-kerning:0pt">1</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Courier New&quot;;color:black;
mso-font-kerning:0pt">)</span><span lang="EN-US" style="font-size:10.0pt;
font-family:&quot;Courier New&quot;;color:blue;mso-font-kerning:0pt">.</span></span></font></p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal">两种情况都循环读了10W次，连续测试10次，机器配置为：</p>
<p class="MsoNormal">Intel(R) Xeon(R) CPU &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; E5420 &nbsp;@ 2.50GHz &nbsp; &nbsp; &nbsp;2*4核</p>
<p class="MsoNormal">12G内存</p>
<p class="MsoNormal">事务读测试结果：</p>
<p class="MsoNormal">times:100000, wall_clock 4168, runtime:4160ok</p>
<p class="MsoNormal">times:100000, wall_clock 4296, runtime:4250ok</p>
<p class="MsoNormal">times:100000, wall_clock 4338, runtime:4290ok</p>
<p class="MsoNormal">times:100000, wall_clock 4310, runtime:4260ok</p>
<p class="MsoNormal">times:100000, wall_clock 4330, runtime:4280ok</p>
<p class="MsoNormal">times:100000, wall_clock 4342, runtime:4270ok</p>
<p class="MsoNormal">times:100000, wall_clock 4399, runtime:4310ok</p>
<p class="MsoNormal">times:100000, wall_clock 4366, runtime:4310ok</p>
<p class="MsoNormal">times:100000, wall_clock 4378, runtime:4310ok</p>
<p class="MsoNormal">times:100000, wall_clock 4429, runtime:4330ok</p>
<p class="MsoNormal"><span style="color:#f00;">一次读的时间大于为44us，这还是在没有分布式的情况下的测试结果，如果是在分布式环境中，由于网络IO和远程加锁，性能会更差。</span></p>
<p class="MsoNormal">脏读测试结果：</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal">times:100000, wall_clock 128, runtime:130ok</p>
<p class="MsoNormal">times:100000, wall_clock 126, runtime:120ok</p>
<p class="MsoNormal">times:100000, wall_clock 124, runtime:120ok</p>
<p class="MsoNormal">times:100000, wall_clock 126, runtime:120ok</p>
<p class="MsoNormal">times:100000, wall_clock 127, runtime:130ok</p>
<p class="MsoNormal">times:100000, wall_clock 125, runtime:130ok</p>
<p class="MsoNormal">times:100000, wall_clock 125, runtime:120ok</p>
<p class="MsoNormal">times:100000, wall_clock 127, runtime:120ok</p>
<p class="MsoNormal">times:100000, wall_clock 128, runtime:130ok</p>
<p class="MsoNormal">times:100000, wall_clock 127, runtime:130ok</p>
<p class="MsoNormal"><span style="color: rgb(255, 0, 0); ">和ets的性能几乎一样，一次读取的消耗大约1.2us，和事务相比快了几十倍。</span>追踪脏读源码到mnesia_lib.erl中：</p>
<p align="left" class="MsoNormal" style="text-align: left; "><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: black; ">db_get(</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: rgb(184, 134, 11); ">Tab</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: black; ">,&nbsp;</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: rgb(184, 134, 11); ">Key</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: black; ">) -&gt;</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; "><o:p></o:p></span></p>
<p align="left" class="MsoNormal" style="text-align: left; "><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: black; "><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>db_get(val({</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: rgb(184, 134, 11); ">Tab</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: black; ">, storage_type}),&nbsp;</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: rgb(184, 134, 11); ">Tab</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: black; ">,&nbsp;</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: rgb(184, 134, 11); ">Key</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: black; ">)</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: blue; ">.</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; "><o:p></o:p></span></p>
<p align="left" class="MsoNormal" style="text-align: left; "><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: black; ">db_get(ram_copies,&nbsp;</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: rgb(184, 134, 11); ">Tab</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: black; ">,&nbsp;</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: rgb(184, 134, 11); ">Key</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: black; ">) -&gt;&nbsp;</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: rgb(95, 158, 160); ">?ets_lookup</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: black; ">(</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: rgb(184, 134, 11); ">Tab</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: black; ">,&nbsp;</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: rgb(184, 134, 11); ">Key</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: black; ">);</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; "><o:p></o:p></span></p>
<p align="left" class="MsoNormal" style="text-align: left; "><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: black; ">db_get(disc_copies,&nbsp;</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: rgb(184, 134, 11); ">Tab</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: black; ">,&nbsp;</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: rgb(184, 134, 11); ">Key</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: black; ">) -&gt;&nbsp;</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: rgb(95, 158, 160); ">?ets_lookup</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: black; ">(</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: rgb(184, 134, 11); ">Tab</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: black; ">,&nbsp;</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: rgb(184, 134, 11); ">Key</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: black; ">);</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; "><o:p></o:p></span></p>
<p class="MsoNormal" style="text-indent: 24pt; "><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: black; ">db_get(disc_only_copies,&nbsp;</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: rgb(184, 134, 11); ">Tab</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: black; ">,&nbsp;</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: rgb(184, 134, 11); ">Key</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: black; ">) -&gt; dets:lookup(</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: rgb(184, 134, 11); ">Tab</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: black; ">,&nbsp;</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: rgb(184, 134, 11); ">Key</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: black; ">)</span><span lang="EN-US" style="font-size: 10pt; font-family: 'Courier New'; color: blue; ">.</span></p>
<p class="MsoNormal" style="text-indent: 24pt; ">呵呵，果然是ets直接操作。</p>

<!--
author: qingliangcn
date: 2010-08-03
title: erlang init stop浅析
tags: Erlang,erlang停止过程,init,otp,stop
category: Erlang
status: publish
summary: 	作者：庆亮 (qing.liang.cn@gmail.com)	日期：2010-08-03	&nbsp;	&nbsp;	boot之后关注的自然是stop，直接打开erts-5.7.5/src/init.erl源码看了看：	&nbsp;	-spec stop() -&gt; no
-->

<p class="MsoNormal" style="margin: 0cm 0cm 0pt">
	<b style="mso-bidi-font-weight: normal"><font color="#000000"><font size="3"><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">作者：庆亮</span><span lang="EN-US"><font face="Calibri"> (qing.liang.cn@gmail.com)<o:p></o:p></font></span></font></font></b>
</p>

<p class="MsoNormal" style="margin: 0cm 0cm 0pt">
	<b style="mso-bidi-font-weight: normal"><font color="#000000"><font size="3"><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">日期：</span><span lang="EN-US"><font face="Calibri">2010-08-03<o:p></o:p></font></span></font></font></b>
</p>

<p class="MsoNormal" style="margin: 0cm 0cm 0pt">
	<span lang="EN-US"><o:p><font color="#000000" face="Calibri" size="3">&nbsp;</font></o:p></span>
</p>

<p class="MsoNormal" style="margin: 0cm 0cm 0pt">
	<span lang="EN-US"><o:p><font color="#000000" face="Calibri" size="3">&nbsp;</font></o:p></span>
</p>

<p class="MsoNormal" style="margin: 0cm 0cm 0pt">
	<font color="#000000"><font size="3"><span lang="EN-US"><font face="Calibri">boot</font></span><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">之后关注的自然是</span><span lang="EN-US"><font face="Calibri">stop</font></span><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">，直接打开</span><span lang="EN-US"><font face="Calibri">erts-5.7.5/src/init.erl</font></span><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">源码看了看：</span></font></font>
</p>

<p class="MsoNormal" style="margin: 0cm 0cm 0pt">
	<span lang="EN-US"><o:p><font color="#000000" face="Calibri" size="3">&nbsp;</font></o:p></span>
</p>

<p align="left" class="MsoNormal" style="text-align: left; margin: 0cm 0cm 0pt">
	<font size="3"><span lang="EN-US" style="font-family: consolas; color: black">-</span><b><span lang="EN-US" style="font-family: consolas; color: #999999">spec</span></b><span lang="EN-US" style="font-family: consolas; color: black"> stop() </span><span lang="EN-US" style="font-family: consolas; color: #666666">-&gt;</span></font><font size="3"><span lang="EN-US" style="font-family: consolas; color: black"> no_return().</span><br />
	<span lang="EN-US" style="font-family: consolas; color: #00a000">stop</span><span lang="EN-US" style="font-family: consolas; color: black">() </span><span lang="EN-US" style="font-family: consolas; color: #666666">-&gt;</span><span lang="EN-US" style="font-family: consolas; color: black"> init </span><span lang="EN-US" style="font-family: consolas; color: #666666">!</span></font><font size="3"><span lang="EN-US" style="font-family: consolas; color: black"> {stop,stop}, ok.</span></font>
</p>

<p>
	<font size="3">{stop,<span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Reason</span><span lang="EN-US" style="font-family: consolas; color: black">} </span><span lang="EN-US" style="font-family: consolas; color: #666666">-&gt;</span></font><br />
	<span lang="EN-US" style="font-family: consolas; color: black"><font size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stop(</font></span><font size="3"><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Reason</span><span lang="EN-US" style="font-family: consolas; color: black">,</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">State</span><span lang="EN-US" style="font-family: consolas; color: black">);<!--more--><o:p></o:p></span></font>
</p>

<p align="left" class="MsoNormal" style="text-align: left; margin: 0cm 0cm 0pt">
	<span lang="EN-US" style="font-family: consolas; color: black"><o:p><font size="3">&nbsp;</font></o:p></span>
</p>

<p align="left" class="MsoNormal" style="text-align: left; margin: 0cm 0cm 0pt">
	<span style="font-family: 宋体; color: black; mso-ascii-font-family: consolas; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: consolas"><font size="3">最终的调用：</font></span>
</p>

<p align="left" class="MsoNormal" style="text-align: left; margin: 0cm 0cm 0pt">
	<font size="3"><span lang="EN-US" style="font-family: consolas; color: #00a000">stop</span><span lang="EN-US" style="font-family: consolas; color: black">(</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Reason</span><span lang="EN-US" style="font-family: consolas; color: black">,</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">State</span><span lang="EN-US" style="font-family: consolas; color: black">) </span><span lang="EN-US" style="font-family: consolas; color: #666666">-&gt;</span></font><br />
	<span lang="EN-US" style="font-family: consolas; color: black"><font size="3">&nbsp;&nbsp;&nbsp; </font></span><font size="3"><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">BootPid</span><span lang="EN-US" style="font-family: consolas; color: black"> </span><span lang="EN-US" style="font-family: consolas; color: #666666">=</span><span lang="EN-US" style="font-family: consolas; color: black"> </span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">State</span><span lang="EN-US" style="font-family: consolas; color: #a0a000">#state.bootpid</span></font><font size="3"><span lang="EN-US" style="font-family: consolas; color: black">,<br />
	&nbsp;&nbsp;&nbsp; {_,</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Progress</span><span lang="EN-US" style="font-family: consolas; color: black">} </span><span lang="EN-US" style="font-family: consolas; color: #666666">=</span><span lang="EN-US" style="font-family: consolas; color: black"> </span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">State</span><span lang="EN-US" style="font-family: consolas; color: #a0a000">#state.status</span></font><font size="3"><span lang="EN-US" style="font-family: consolas; color: black">,<br />
	&nbsp;&nbsp;&nbsp; </span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">State1</span><span lang="EN-US" style="font-family: consolas; color: black"> </span><span lang="EN-US" style="font-family: consolas; color: #666666">=</span><span lang="EN-US" style="font-family: consolas; color: black"> </span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">State</span><span lang="EN-US" style="font-family: consolas; color: #a0a000">#state</span><span lang="EN-US" style="font-family: consolas; color: black">{status </span><span lang="EN-US" style="font-family: consolas; color: #666666">=</span><span lang="EN-US" style="font-family: consolas; color: black"> {stopping, </span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Progress</span></font><font size="3"><span lang="EN-US" style="font-family: consolas; color: black">}},<br />
	&nbsp;&nbsp;&nbsp; clear_system(</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">BootPid</span><span lang="EN-US" style="font-family: consolas; color: black">,</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">State1</span></font><font size="3"><span lang="EN-US" style="font-family: consolas; color: black">),<br />
	&nbsp;&nbsp;&nbsp; do_stop(</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Reason</span><span lang="EN-US" style="font-family: consolas; color: black">,</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">State1</span><span lang="EN-US" style="font-family: consolas; color: black">).<o:p></o:p></span></font>
</p>

<p align="left" class="MsoNormal" style="text-align: left; margin: 0cm 0cm 0pt">
	<span lang="EN-US" style="font-family: consolas; color: black"><o:p><font size="3">&nbsp;</font></o:p></span>
</p>

<p class="MsoNormal" style="margin: 0cm 0cm 0pt">
	<font color="#000000"><font size="3"><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">看看</span><span lang="EN-US"><font face="Calibri"> clear_system/2</font></span><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">：</span></font></font>
</p>

<p class="MsoNormal" style="margin: 0cm 0cm 0pt">
	<span lang="EN-US"><o:p><font color="#000000" face="Calibri" size="3">&nbsp;</font></o:p></span>
</p>

<p align="left" class="MsoNormal" style="text-align: left; margin: 0cm 0cm 0pt">
	<font size="3"><span lang="EN-US" style="font-family: consolas; color: #00a000">clear_system</span><span lang="EN-US" style="font-family: consolas; color: black">(</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">BootPid</span><span lang="EN-US" style="font-family: consolas; color: black">,</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">State</span><span lang="EN-US" style="font-family: consolas; color: black">) </span><span lang="EN-US" style="font-family: consolas; color: #666666">-&gt;</span></font><br />
	<span lang="EN-US" style="font-family: consolas; color: black"><font size="3">&nbsp;&nbsp;&nbsp; </font></span><font size="3"><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Heart</span><span lang="EN-US" style="font-family: consolas; color: black"> </span><span lang="EN-US" style="font-family: consolas; color: #666666">=</span><span lang="EN-US" style="font-family: consolas; color: black"> get_heart(</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">State</span><span lang="EN-US" style="font-family: consolas; color: #a0a000">#state.kernel</span></font><font size="3"><span lang="EN-US" style="font-family: consolas; color: black">),<br />
	&nbsp;&nbsp;&nbsp; shutdown_pids(</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Heart</span><span lang="EN-US" style="font-family: consolas; color: black">,</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">BootPid</span><span lang="EN-US" style="font-family: consolas; color: black">,</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">State</span></font><font size="3"><span lang="EN-US" style="font-family: consolas; color: black">),<br />
	&nbsp;&nbsp;&nbsp; unload(</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Heart</span></font><font size="3"><span lang="EN-US" style="font-family: consolas; color: black">).<br />
	&nbsp;&nbsp;&nbsp; </span><br />
	<span lang="EN-US" style="font-family: consolas; color: #00a000">shutdown_pids</span><span lang="EN-US" style="font-family: consolas; color: black">(</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Heart</span><span lang="EN-US" style="font-family: consolas; color: black">,</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">BootPid</span><span lang="EN-US" style="font-family: consolas; color: black">,</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">State</span><span lang="EN-US" style="font-family: consolas; color: black">) </span><span lang="EN-US" style="font-family: consolas; color: #666666">-&gt;</span></font><br />
	<span lang="EN-US" style="font-family: consolas; color: black"><font size="3">&nbsp;&nbsp;&nbsp; </font></span><font size="3"><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Timer</span><span lang="EN-US" style="font-family: consolas; color: black"> </span><span lang="EN-US" style="font-family: consolas; color: #666666">=</span><span lang="EN-US" style="font-family: consolas; color: black"> shutdown_timer(</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">State</span><span lang="EN-US" style="font-family: consolas; color: #a0a000">#state.flags</span></font><font size="3"><span lang="EN-US" style="font-family: consolas; color: black">),<br />
	&nbsp;&nbsp;&nbsp; </span><b><span lang="EN-US" style="font-family: consolas; color: #aa22ff">catch</span></b><span lang="EN-US" style="font-family: consolas; color: black"> shutdown(</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">State</span><span lang="EN-US" style="font-family: consolas; color: #a0a000">#state.kernel</span><span lang="EN-US" style="font-family: consolas; color: black">,</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">BootPid</span><span lang="EN-US" style="font-family: consolas; color: black">,</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Timer</span><span lang="EN-US" style="font-family: consolas; color: black">,</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">State</span></font><font size="3"><span lang="EN-US" style="font-family: consolas; color: black">),<br />
	&nbsp;&nbsp;&nbsp; kill_all_pids(</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Heart</span><span lang="EN-US" style="font-family: consolas; color: black">), </span><i><span lang="EN-US" style="font-family: consolas; color: #008800">% Even the shutdown timer.</span></i></font><br />
	<span lang="EN-US" style="font-family: consolas; color: black"><font size="3">&nbsp;&nbsp;&nbsp; kill_all_ports(</font></span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod"><font size="3">Heart</font></span><font size="3"><span lang="EN-US" style="font-family: consolas; color: black">),<br />
	&nbsp;&nbsp;&nbsp; flush_timout(</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Timer</span></font><font size="3"><span lang="EN-US" style="font-family: consolas; color: black">).<br />
	&nbsp;&nbsp;&nbsp; </span><br />
	<i><span lang="EN-US" style="font-family: consolas; color: #008800">%%</span></i></font><br />
	<i><span lang="EN-US" style="font-family: consolas; color: #008800"><font size="3">%% Kill all existing pids in the system (except init and heart).</font></span></i><br />
	<font size="3"><span lang="EN-US" style="font-family: consolas; color: #00a000">kill_all_pids</span><span lang="EN-US" style="font-family: consolas; color: black">(</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Heart</span><span lang="EN-US" style="font-family: consolas; color: black">) </span><span lang="EN-US" style="font-family: consolas; color: #666666">-&gt;</span></font><br />
	<span lang="EN-US" style="font-family: consolas; color: black"><font size="3">&nbsp;&nbsp;&nbsp; </font></span><font size="3"><b><span lang="EN-US" style="font-family: consolas; color: #aa22ff">case</span></b><span lang="EN-US" style="font-family: consolas; color: black"> get_pids(</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Heart</span><span lang="EN-US" style="font-family: consolas; color: black">) </span><b><span lang="EN-US" style="font-family: consolas; color: #aa22ff">of</span></b></font><br />
	<span lang="EN-US" style="font-family: consolas; color: black"><font size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [] </font></span><span lang="EN-US" style="font-family: consolas; color: #666666"><font size="3">-&gt;</font></span><br />
	<span lang="EN-US" style="font-family: consolas; color: black"><font size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ok;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font size="3"><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Pids</span><span lang="EN-US" style="font-family: consolas; color: black"> </span><span lang="EN-US" style="font-family: consolas; color: #666666">-&gt;</span></font><br />
	<span lang="EN-US" style="font-family: consolas; color: black"><font size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; kill_em(</font></span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod"><font size="3">Pids</font></span><font size="3"><span lang="EN-US" style="font-family: consolas; color: black">),<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; kill_all_pids(</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Heart</span><span lang="EN-US" style="font-family: consolas; color: black">)&nbsp; </span><i><span lang="EN-US" style="font-family: consolas; color: #008800">% Continue until all are really killed.</span></i></font><br />
	<span lang="EN-US" style="font-family: consolas; color: black"><font size="3">&nbsp;&nbsp;&nbsp; </font></span><b><span lang="EN-US" style="font-family: consolas; color: #aa22ff"><font size="3">end</font></span></b><font size="3"><span lang="EN-US" style="font-family: consolas; color: black">.</span></font>
</p>

<p>
	<font size="3"><span lang="EN-US" style="font-family: consolas; color: #00a000">kill_em</span><span lang="EN-US" style="font-family: consolas; color: black">([</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Pid</span><span lang="EN-US" style="font-family: consolas; color: black">|</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Pids</span><span lang="EN-US" style="font-family: consolas; color: black">]) </span><span lang="EN-US" style="font-family: consolas; color: #666666">-&gt;</span></font><br />
	<span lang="EN-US" style="font-family: consolas; color: black"><font size="3">&nbsp;&nbsp;&nbsp; </font></span><font size="3"><span lang="EN-US" style="font-family: consolas; color: #aa22ff">exit</span><span lang="EN-US" style="font-family: consolas; color: black">(</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Pid</span></font><font size="3"><span lang="EN-US" style="font-family: consolas; color: black">,kill),<br />
	&nbsp;&nbsp;&nbsp; kill_em(</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Pids</span></font><font size="3"><span lang="EN-US" style="font-family: consolas; color: black">);</span><br />
	<span lang="EN-US" style="font-family: consolas; color: #00a000">kill_em</span><span lang="EN-US" style="font-family: consolas; color: black">([]) </span><span lang="EN-US" style="font-family: consolas; color: #666666">-&gt;</span></font><br />
	<span lang="EN-US" style="font-family: consolas; color: black"><font size="3">&nbsp;&nbsp;&nbsp; ok.<o:p></o:p></font></span>
</p>

<p align="left" class="MsoNormal" style="text-align: left; margin: 0cm 0cm 0pt">
	<span lang="EN-US" style="font-family: consolas; color: black"><o:p><font size="3">&nbsp;</font></o:p></span>
</p>

<p align="left" class="MsoNormal" style="text-align: left; margin: 0cm 0cm 0pt">
	<font size="3"><span style="font-family: 宋体; color: black; mso-ascii-font-family: consolas; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: consolas">看到这里得到两个结论：</span><span lang="EN-US" style="font-family: consolas; color: black"><o:p></o:p></span></font>
</p>

<p align="left" class="MsoListParagraph" style="text-align: left; text-indent: -18pt; margin: 0cm 0cm 0pt 39pt; mso-char-indent-count: 0; mso-list: l0 level1 lfo1">
	<span lang="EN-US" style="font-family: consolas; color: black; mso-fareast-font-family: consolas; mso-bidi-font-family: consolas"><span style="mso-list: ignore"><font size="3">1．</font><span style="font: 7pt 'times new roman'"> </span></span></span><font size="3"><span style="font-family: 宋体; color: black; mso-ascii-font-family: consolas; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: consolas">除了</span><span lang="EN-US" style="font-family: consolas; color: black">kernel</span><span style="font-family: 宋体; color: black; mso-ascii-font-family: consolas; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: consolas">和</span><span lang="EN-US" style="font-family: consolas; color: black">init</span><span style="font-family: 宋体; color: black; mso-ascii-font-family: consolas; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: consolas">之外的所有的进程都是以</span><span lang="EN-US" style="font-family: consolas; color: black">kill</span><span style="font-family: 宋体; color: black; mso-ascii-font-family: consolas; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: consolas">的形式干掉的。注意这里的</span><span lang="EN-US" style="font-family: consolas; color: black">kernel</span><span style="font-family: 宋体; color: black; mso-ascii-font-family: consolas; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: consolas">是个</span><span lang="EN-US" style="font-family: consolas; color: black">list</span><span style="font-family: 宋体; color: black; mso-ascii-font-family: consolas; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: consolas">，包含多了</span><span lang="EN-US" style="font-family: consolas; color: black">pid</span></font>
</p>

<p align="left" class="MsoListParagraph" style="text-align: left; text-indent: -18pt; margin: 0cm 0cm 0pt 39pt; mso-char-indent-count: 0; mso-list: l0 level1 lfo1">
	<span lang="EN-US" style="font-family: consolas; color: black; mso-fareast-font-family: consolas; mso-bidi-font-family: consolas"><span style="mso-list: ignore"><font size="3">2．</font><span style="font: 7pt 'times new roman'"> </span></span></span><font color="#000000"><font size="3"><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">先</span><span lang="EN-US"><font face="Calibri">shutdown</font></span><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">所有的</span><span lang="EN-US"><font face="Calibri">kernel</font></span><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">进程，后</span><span lang="EN-US"><font face="Calibri">kill</font></span><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">掉其他进程，最终</span><span lang="EN-US"><font face="Calibri">halt</font></span><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">。</span><span lang="EN-US"><font face="Calibri">shutdown</font></span><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">的形式则是一条</span><span lang="EN-US"><font face="Calibri">EXIT</font></span><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">消息</span></font></font>
</p>

<p align="left" class="MsoNormal" style="text-align: left; margin: 0cm 0cm 0pt">
	<span lang="EN-US"><o:p><font color="#000000" face="Calibri" size="3">&nbsp;</font></o:p></span>
</p>

<p align="left" class="MsoNormal" style="text-align: left; margin: 0cm 0cm 0pt">
	<font size="3"><span lang="EN-US" style="font-family: consolas; color: #00a000">shutdown</span><span lang="EN-US" style="font-family: consolas; color: black">([{heart,_</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Pid</span><span lang="EN-US" style="font-family: consolas; color: black">}|</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Kernel</span><span lang="EN-US" style="font-family: consolas; color: black">],</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">BootPid</span><span lang="EN-US" style="font-family: consolas; color: black">,</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Timer</span><span lang="EN-US" style="font-family: consolas; color: black">,</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">State</span><span lang="EN-US" style="font-family: consolas; color: black">) </span><span lang="EN-US" style="font-family: consolas; color: #666666">-&gt;</span></font><br />
	<span lang="EN-US" style="font-family: consolas; color: black"><font size="3">&nbsp;&nbsp;&nbsp; shutdown(</font></span><font size="3"><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Kernel</span><span lang="EN-US" style="font-family: consolas; color: black">, </span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">BootPid</span><span lang="EN-US" style="font-family: consolas; color: black">, </span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Timer</span><span lang="EN-US" style="font-family: consolas; color: black">, </span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">State</span></font><font size="3"><span lang="EN-US" style="font-family: consolas; color: black">);</span><br />
	<span lang="EN-US" style="font-family: consolas; color: #00a000">shutdown</span><span lang="EN-US" style="font-family: consolas; color: black">([{_</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Name</span><span lang="EN-US" style="font-family: consolas; color: black">,</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Pid</span><span lang="EN-US" style="font-family: consolas; color: black">}|</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Kernel</span><span lang="EN-US" style="font-family: consolas; color: black">],</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">BootPid</span><span lang="EN-US" style="font-family: consolas; color: black">,</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Timer</span><span lang="EN-US" style="font-family: consolas; color: black">,</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">State</span><span lang="EN-US" style="font-family: consolas; color: black">) </span><span lang="EN-US" style="font-family: consolas; color: #666666">-&gt;</span></font><br />
	<span lang="EN-US" style="font-family: consolas; color: black"><font size="3">&nbsp;&nbsp;&nbsp; shutdown_kernel_pid(</font></span><font size="3"><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Pid</span><span lang="EN-US" style="font-family: consolas; color: black">, </span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">BootPid</span><span lang="EN-US" style="font-family: consolas; color: black">, </span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Timer</span><span lang="EN-US" style="font-family: consolas; color: black">, </span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">State</span></font><font size="3"><span lang="EN-US" style="font-family: consolas; color: black">),<br />
	&nbsp;&nbsp;&nbsp; shutdown(</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Kernel</span><span lang="EN-US" style="font-family: consolas; color: black">,</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">BootPid</span><span lang="EN-US" style="font-family: consolas; color: black">,</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Timer</span><span lang="EN-US" style="font-family: consolas; color: black">,</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">State</span></font><font size="3"><span lang="EN-US" style="font-family: consolas; color: black">);</span><br />
	<span lang="EN-US" style="font-family: consolas; color: #00a000">shutdown</span><span lang="EN-US" style="font-family: consolas; color: black">(_,_,_,_) </span><span lang="EN-US" style="font-family: consolas; color: #666666">-&gt;</span></font><br />
	<span lang="EN-US" style="font-family: consolas; color: black"><font size="3">&nbsp;&nbsp;&nbsp; true.</font></span>
</p>

<p>
	<i><span lang="EN-US" style="font-family: consolas; color: #008800"><font size="3">%%</font></span></i><br />
	<i><span lang="EN-US" style="font-family: consolas; color: #008800"><font size="3">%% A kernel pid must handle the special case message</font></span></i><br />
	<i><span lang="EN-US" style="font-family: consolas; color: #008800"><font size="3">%% {&#39;EXIT&#39;,Parent,Reason} and terminate upon it!</font></span></i><br />
	<i><span lang="EN-US" style="font-family: consolas; color: #008800"><font size="3">%%</font></span></i><br />
	<font size="3"><span lang="EN-US" style="font-family: consolas; color: #00a000">shutdown_kernel_pid</span><span lang="EN-US" style="font-family: consolas; color: black">(</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Pid</span><span lang="EN-US" style="font-family: consolas; color: black">, </span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">BootPid</span><span lang="EN-US" style="font-family: consolas; color: black">, </span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Timer</span><span lang="EN-US" style="font-family: consolas; color: black">, </span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">State</span><span lang="EN-US" style="font-family: consolas; color: black">) </span><span lang="EN-US" style="font-family: consolas; color: #666666">-&gt;</span></font><br />
	<span lang="EN-US" style="font-family: consolas; color: black"><font size="3">&nbsp;&nbsp;&nbsp; </font></span><font size="3"><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Pid</span><span lang="EN-US" style="font-family: consolas; color: black"> </span><span lang="EN-US" style="font-family: consolas; color: #666666">!</span><span lang="EN-US" style="font-family: consolas; color: black"> {&#39;EXIT&#39;,</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">BootPid</span></font><font size="3"><span lang="EN-US" style="font-family: consolas; color: black">,shutdown},<br />
	&nbsp;&nbsp;&nbsp; shutdown_loop(</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Pid</span><span lang="EN-US" style="font-family: consolas; color: black">, </span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Timer</span><span lang="EN-US" style="font-family: consolas; color: black">, </span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">State</span><span lang="EN-US" style="font-family: consolas; color: black">, []).<o:p></o:p></span></font>
</p>

<p align="left" class="MsoNormal" style="text-align: left; margin: 0cm 0cm 0pt">
	<span lang="EN-US" style="font-family: consolas; color: black"><o:p><font size="3">&nbsp;</font></o:p></span>
</p>

<p align="left" class="MsoNormal" style="text-align: left; margin: 0cm 0cm 0pt">
	<font size="3"><span style="font-family: 宋体; color: black; mso-ascii-font-family: consolas; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: consolas">发送</span><span lang="EN-US" style="font-family: consolas; color: black">EXIT</span><span style="font-family: 宋体; color: black; mso-ascii-font-family: consolas; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: consolas">消息，</span><span lang="EN-US" style="font-family: consolas; color: black">shutdown_loop/4</span><span style="font-family: 宋体; color: black; mso-ascii-font-family: consolas; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: consolas">等待结果。</span></font>
</p>

<p align="left" class="MsoNormal" style="text-align: left; margin: 0cm 0cm 0pt">
	<span lang="EN-US"><o:p><font color="#000000" face="Calibri" size="3">&nbsp;</font></o:p></span>
</p>

<p align="left" class="MsoNormal" style="text-align: left; margin: 0cm 0cm 0pt">
	<font color="#000000"><font size="3"><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">根据上一篇分析的结果，</span><span lang="EN-US"><font face="Calibri">application_controller</font></span><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">是</span><span lang="EN-US"><font face="Calibri">kernel pids</font></span><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">的一员，查看</span><span lang="EN-US"><font face="Calibri">application_controller</font></span><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">的源码：</span></font></font>
</p>

<p align="left" class="MsoNormal" style="text-align: left; margin: 0cm 0cm 0pt">
	<font size="3"><span lang="EN-US" style="font-family: consolas; color: #00a000">terminate</span><span lang="EN-US" style="font-family: consolas; color: black">(</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Reason</span><span lang="EN-US" style="font-family: consolas; color: black">, S) </span><span lang="EN-US" style="font-family: consolas; color: #666666">-&gt;</span></font><br />
	<span lang="EN-US" style="font-family: consolas; color: black"><font size="3">&nbsp;&nbsp;&nbsp; </font></span><font size="3"><b><span lang="EN-US" style="font-family: consolas; color: #aa22ff">case</span></b><span lang="EN-US" style="font-family: consolas; color: black"> </span><b><span lang="EN-US" style="font-family: consolas; color: blue">application</span></b><span lang="EN-US" style="font-family: consolas; color: black">:get_env(kernel, shutdown_func) </span><b><span lang="EN-US" style="font-family: consolas; color: #aa22ff">of</span></b></font><br />
	<span lang="EN-US" style="font-family: consolas; color: black"><font size="3">&nbsp;&nbsp;&nbsp; {ok, {</font></span><font size="3"><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">M</span><span lang="EN-US" style="font-family: consolas; color: black">, </span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">F</span><span lang="EN-US" style="font-family: consolas; color: black">}} </span><span lang="EN-US" style="font-family: consolas; color: #666666">-&gt;</span></font><br />
	<span lang="EN-US" style="font-family: consolas; color: black"><font size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font size="3"><b><span lang="EN-US" style="font-family: consolas; color: #aa22ff">catch</span></b><span lang="EN-US" style="font-family: consolas; color: black"> </span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">M</span><span lang="EN-US" style="font-family: consolas; color: black">:</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">F</span><span lang="EN-US" style="font-family: consolas; color: black">(</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Reason</span></font><font size="3"><span lang="EN-US" style="font-family: consolas; color: black">);<br />
	&nbsp;&nbsp;&nbsp; _ </span><span lang="EN-US" style="font-family: consolas; color: #666666">-&gt;</span></font><br />
	<span lang="EN-US" style="font-family: consolas; color: black"><font size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ok<br />
	&nbsp;&nbsp;&nbsp; </font></span><b><span lang="EN-US" style="font-family: consolas; color: #aa22ff"><font size="3">end</font></span></b><font size="3"><span lang="EN-US" style="font-family: consolas; color: black">,<br />
	&nbsp;&nbsp;&nbsp; foreach(</span><b><span lang="EN-US" style="font-family: consolas; color: #aa22ff">fun</span></b><span lang="EN-US" style="font-family: consolas; color: black">({_</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">AppName</span><span lang="EN-US" style="font-family: consolas; color: black">, </span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Id</span><span lang="EN-US" style="font-family: consolas; color: black">}) </span><b><span lang="EN-US" style="font-family: consolas; color: #aa22ff">when</span></b><span lang="EN-US" style="font-family: consolas; color: black"> </span><span lang="EN-US" style="font-family: consolas; color: #aa22ff">is_pid</span><span lang="EN-US" style="font-family: consolas; color: black">(</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Id</span><span lang="EN-US" style="font-family: consolas; color: black">) </span><span lang="EN-US" style="font-family: consolas; color: #666666">-&gt;</span></font><br />
	<font size="3"><span lang="EN-US" style="font-family: consolas; color: black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span lang="EN-US" style="font-family: consolas; color: #aa22ff">exit</span><span lang="EN-US" style="font-family: consolas; color: black">(</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Id</span></font><font size="3"><span lang="EN-US" style="font-family: consolas; color: black">, shutdown),<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><span lang="EN-US" style="font-family: consolas; color: #aa22ff">receive</span></b></font><br />
	<span lang="EN-US" style="font-family: consolas; color: black"><font size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&#39;EXIT&#39;, </font></span><font size="3"><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Id</span><span lang="EN-US" style="font-family: consolas; color: black">, _} </span><span lang="EN-US" style="font-family: consolas; color: #666666">-&gt;</span></font><font size="3"><span lang="EN-US" style="font-family: consolas; color: black"> ok<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><span lang="EN-US" style="font-family: consolas; color: #aa22ff">end</span></b></font><font size="3"><span lang="EN-US" style="font-family: consolas; color: black">;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (_) </span><span lang="EN-US" style="font-family: consolas; color: #666666">-&gt;</span></font><font size="3"><span lang="EN-US" style="font-family: consolas; color: black"> ok<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><span lang="EN-US" style="font-family: consolas; color: #aa22ff">end</span></b></font><font size="3"><span lang="EN-US" style="font-family: consolas; color: black">,<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; S</span><span lang="EN-US" style="font-family: consolas; color: #a0a000">#state.running</span></font><font size="3"><span lang="EN-US" style="font-family: consolas; color: black">),</span><br />
	<b><span lang="EN-US" style="font-family: consolas; color: blue">ets</span></b><span lang="EN-US" style="font-family: consolas; color: black">:delete(ac_tab).<o:p></o:p></span></font>
</p>

<p align="left" class="MsoNormal" style="text-align: left; margin: 0cm 0cm 0pt">
	<span lang="EN-US" style="font-family: consolas; color: black"><o:p><font size="3">&nbsp;</font></o:p></span>
</p>

<p align="left" class="MsoNormal" style="text-align: left; margin: 0cm 0cm 0pt">
	<font size="3"><span lang="EN-US" style="font-family: consolas; color: black">S</span><span lang="EN-US" style="font-family: consolas; color: #a0a000">#state.running</span><font color="#000000"><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">中保存了所有已经在运行的</span><span lang="EN-US"><font face="Calibri">application</font></span><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">，对于每一个</span><span lang="EN-US"><font face="Calibri">application</font></span><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">，都以</span></font><span lang="EN-US" style="font-family: consolas; color: #aa22ff">exit</span><span lang="EN-US" style="font-family: consolas; color: black">(</span><span lang="EN-US" style="font-family: consolas; color: darkgoldenrod">Id</span><span lang="EN-US" style="font-family: consolas; color: black">, shutdown)</span><span style="font-family: 宋体; color: black; mso-ascii-font-family: consolas; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: consolas">形式让其退出，并一直等待。</span></font>
</p>

<p align="left" class="MsoNormal" style="text-align: left; text-indent: 9pt; margin: 0cm 0cm 0pt">
	<span lang="EN-US"><o:p><font color="#000000" face="Calibri" size="3">&nbsp;</font></o:p></span>
</p>

<p align="left" class="MsoNormal" style="text-align: left; margin: 0cm 0cm 0pt">
	<span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin"><font color="#000000" size="3">到了这里不用继续看源码大致也能理清思路了，结论：</font></span>
</p>

<p align="left" class="MsoNormal" style="text-align: left; margin: 0cm 0cm 0pt">
	<span lang="EN-US"><o:p><font color="#000000" face="Calibri" size="3">&nbsp;</font></o:p></span>
</p>

<p align="left" class="MsoNormal" style="text-align: left; margin: 0cm 0cm 0pt">
	<b style="mso-bidi-font-weight: normal"><span lang="EN-US"><font face="Calibri"><font size="3"><font color="#000000">init:stop<span style="mso-spacerun: yes">&nbsp; </span><o:p></o:p></font></font></font></span></b>
</p>

<p align="left" class="MsoNormal" style="text-align: left; margin: 0cm 0cm 0pt">
	<font size="3"><font color="#000000"><b style="mso-bidi-font-weight: normal"><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">&rarr;</span><span lang="EN-US"><span style="mso-spacerun: yes"><font face="Calibri">&nbsp; </font></span></span></b><b style="mso-bidi-font-weight: normal"><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">向所有</span><span lang="EN-US"><font face="Calibri">kernel</font></span></b><b style="mso-bidi-font-weight: normal"><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">进程发送</span><span lang="EN-US"><font face="Calibri">shutdown Exit</font></span></b><b style="mso-bidi-font-weight: normal"><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">消息</span><font face="Calibri"> <span lang="EN-US"><o:p></o:p></span></font></b></font></font>
</p>

<p align="left" class="MsoNormal" style="text-align: left; margin: 0cm 0cm 0pt">
	<font size="3"><font color="#000000"><b style="mso-bidi-font-weight: normal"><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">&rarr;</span><span lang="EN-US"><font face="Calibri"> application </font></span></b><b style="mso-bidi-font-weight: normal"><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">依次关闭子</span><span lang="EN-US"><font face="Calibri">sup</font></span></b><b style="mso-bidi-font-weight: normal"><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">树（等待）</span><span lang="EN-US"><o:p></o:p></span></b></font></font>
</p>

<p align="left" class="MsoNormal" style="text-align: left; margin: 0cm 0cm 0pt">
	<font size="3"><font color="#000000"><b style="mso-bidi-font-weight: normal"><span lang="EN-US"><span style="mso-spacerun: yes"><font face="Calibri">&nbsp;</font></span></span></b><b style="mso-bidi-font-weight: normal"><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">&rarr;</span><span lang="EN-US"><font face="Calibri"> kill</font></span></b><b style="mso-bidi-font-weight: normal"><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">所有其他的非</span><span lang="EN-US"><font face="Calibri">kernel</font></span></b><b style="mso-bidi-font-weight: normal"><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">进程</span><span lang="EN-US"><o:p></o:p></span></b></font></font>
</p>

<p align="left" class="MsoNormal" style="text-align: left; margin: 0cm 0cm 0pt">
	<span lang="EN-US"><o:p><font color="#000000" face="Calibri" size="3">&nbsp;</font></o:p></span>
</p>

<p align="left" class="MsoNormal" style="text-align: left; margin: 0cm 0cm 0pt">
	<font size="3"><font color="#000000"><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">对于我们的</span><span lang="EN-US"><font face="Calibri">app</font></span><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">，一般都是最后启动，最先停止，如此，在停止我们的</span><span lang="EN-US"><font face="Calibri">app</font></span><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">的时候所有的系统服务都还是可用的（分布式、</span><span lang="EN-US"><font face="Calibri">mnesia</font></span><span style="font-family: 宋体; mso-ascii-font-family: calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: calibri; mso-hansi-theme-font: minor-latin">等等）。</span></font></font>
</p>
